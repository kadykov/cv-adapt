---
// Check if user is already authenticated
const authToken = Astro.cookies.get('auth_token')?.value;
const userJson = Astro.cookies.get('auth_user')?.value;
let initialUser = null;
try {
    initialUser = userJson ? JSON.parse(userJson) : null;
} catch (e) {
    // Invalid user JSON, clear cookies
    Astro.cookies.delete('auth_token');
    Astro.cookies.delete('auth_user');
}

// Redirect based on auth status
const redirectTo = authToken && initialUser ? '/jobs' : '/login';
return Astro.redirect(redirectTo);
---
